# goakit

The `goakit` plugin is a [goa](https://github.com/goadesign/goa/tree/v2) plugin that generates
[Go kit](https://github.com/go-kit/kit) services and clients from goa design packages.

## Usage

goa v2 must be installed:

```bash
go get goa.design/goa/...
```

Simply import the plugin in the service design package. Use the blank identifier `_` as explicit
package name:

```go
package design

import . "goa.design/goa/http/design"
import . "goa.design/goa/http/dsl"
import _ "goa.design/plugins/goakit" # Enables goakit

var _ = API("...
```

and generate as usual:

```bash
goa gen PACKAGE
goa example PACKAGE
```

where `PACKAGE` is the Go import path of the design package.

## Effects of the Plugin

Importing the `goakit` package changes the behavior of both the `gen` and `example` commands of the
`goa` tool. The `gen` command output is modified as follows:

1. The generated code uses `(github.com/go-kit/kit/endpoint).Endpoint` instead of `goa.Endpoint`
   everywhere the `Endpoint` type is used.
2. `goakit` generates a `kitclient` and a `kitserver` packages under the `http` directory which
   define Go kit HTTP encoder and decoder functions.
3. `goakit` also generates the file `mount.go` in the `kitserver` package which define the same
   `MountXXX` functions as the `server` package for convenience.

The `example` command output is modified so that the example server uses the Go kit logger and HTTP
transport struct (defined using the Go kit encoder and decoder functions generated by the `gen`
command).

## Example

The [cellar](https://github.com/goadesign/plugins/tree/master/goakit/examples/cellar)
example
[design](https://github.com/goa.design/plugins/tree/master/goakit/examples/cellar/design/design.go)
illustrates the usage by importing both the official [cellar example design
package](https://github.com/goa.design/goa/tree/v2/examples/cellar/design) and
the goakit plugin.

